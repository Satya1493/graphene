pipeline {
    load 'config.jenkinsfile'
    environment {
        SGX = '1'
        GLIBC_VERSION = '2.27'
    }

    agent {
        dockerfile {
            filename '.ci/ubuntu16.04.dockerfile'
            label 'sgx_slave'
            args "${DOCKER_ARGS}"
        }
    }
    stages {
        load 'lib/stage-lint.jenkinsfile'
        load 'lib/stage-clean-check-prepare.jenkinsfile'
        load 'lib/stage-build-sgx.jenkinsfile'
        load 'lib/stage-test-sgx.jenkinsfile'
    }
}
